# Store coordinates
coords = list()

coords$pernambucanas$campaign2 = data.table( x = c(14.1817543859649,14.1817543859649,5.79789473684211,0,14.1817543859649,14.1817543859649,21.9691228070175,21.9691228070175,31.4045614035088,31.4045614035088), y = c(0,7.16210526315789,7.16210526315789,21.0880701754386,21.0880701754386,43.5968421052632,43.5968421052632,39.0214035087719,39.0214035087719,0))

coords$claro$campaign1 = data.table(x = c(0,0,7.67804154302671,7.67804154302671,6.96275964391691,6.96275964391691), y = c(0.00267062314540059,14.8738872403561,14.8712166172107,8.56824925816024,8.56824925816024,0))

coords$claro$campaign31 = data.table(x = c(0,0,630,630,1545.4,1545.4), y = c(0,1321,1321,997.5,997.5,0))

coords$claro$campaign35 = data.table(x = c(0,0,2230,2230), y = c(0,729,729,0))

# Blacklist
list.vendors = list()
list.vendors$pernambucanas = c("AirgoNet","AtherosC","D-LinkIn","HonHaiPr","Hongkong","MurataMa","Tp-LinkT","Zte","Intermec","SkardinU","Palladiu","HonHaiPr","HuaweiTe","BenruiTe")

# Sensors coords
macs = list()

macs$pernambucanas$campaign2 = data.table(id_sensor = c('18:D6:C7:43:4D:54','18:D6:C7:43:26:48','98:DE:D0:DB:C6:54','98:DE:D0:DB:C2:28','60:E3:27:93:35:96','60:E3:27:93:29:0E','18:D6:C7:43:2A:06','18:D6:C7:43:51:AE','60:E3:27:93:33:E4','98:DE:D0:DB:CB:18','98:DE:D0:A0:55:E0','60:E3:27:93:34:36','18:D6:C7:43:28:F2','98:DE:D0:90:BD:D2','18:D6:C7:43:52:2E','98:DE:D0:DB:C7:86','98:DE:D0:DB:C4:96','98:DE:D0:DB:BE:74','98:DE:D0:DB:C2:1A','18:D6:C7:43:4F:D8','18:D6:C7:43:29:4C','98:DE:D0:DB:C0:8E','18:D6:C7:43:2B:D2'),name = c('Area Masculina - Canto','Provador - Porta','Provador - Lateral','Feminino','Porta da Loja - Sul','Infantil','Area Entrada - Sul','Esportivo','Area Entrada','Fundo Loja','Area Caixa','Porta da Loja','Caixa Fundo','Area Casa - Canto','Provador','Area Masculina','Area Casa','Baia Central - Solo','Area Casa - Emergencia','Baia Central','Caixa','Lingerie','Caixa Meio'),x = c(14.2905263157895,27.7954385964912,30.2066666666667,15.5164912280702,9.54771929824561,31.2315789473684,14.0294736842105,30.6691228070175,13.6073684210526,31.2315789473684,22.3291228070175,4.62421052631579,16.6821052631579,30.3877192982456,30.8901754385965,22.7712280701754,26.9712280701754,14.7126315789474,30.2470175438596,16.8228070175439,16.8428070175439,14.6119298245614,16.6217543859649),y = c(1.11789473684211,15.3663157894737,26.0775438596491,25.2536842105263,7.87017543859649,10.6235087719298,7.4080701754386,0.95719298245614,20.7922807017544,7.46842105263158,38.979298245614,20.4505263157895,41.0694736842105,38.8385964912281,19.0238596491228,5.31824561403509,33.3322807017544,11.5480701754386,28.4287719298246,14.3414035087719,31.6845614035088,21.6764912280702,36.6884210526316))

macs$claro$campaign1 = data.table(id_sensor = c('98:DE:D0:DB:CC:CE','60:E3:27:93:35:7E','98:DE:D0:DB:C7:86','84:16:F9:AC:4A:06','18:A6:F7:AF:4D:54'), name = c('Entrada Segurança', 'TVs', 'Baia Entrada', 'Baia Central', 'Baia Fundo'), x = c(5.7973293768546,3.736646884273,4.92047477744807,1.76557863501484,4.86810089020771), y = c(1.68471810089021,4.77952522255193,7.65712166172107,12.1384272997033,13.6670623145401))

macs$claro$campaign31 = data.table(id_sensor = c("98:DE:D0:DB:CC:CE","98:DE:D0:DB:C7:86","98:DE:D0:A0:61:2A","60:E3:27:93:35:7E","98:DE:D0:DB:D3:BE","18:D6:C7:43:26:48","18:D6:C7:43:4A:94","18:A6:F7:AF:4D:54","84:16:F9:AC:4A:06"), x = c(0.56,0.56,107.5,321.4,818.5,1315.5,1315.5,972.6,345.10), y = c(12.722,1071.83,1329.5,751.1,751.1,635.9,200.5,160.9,309.1))

macs$claro$campaign35 = data.table(id_sensor = c("18:D6:C7:43:51:A6","84:16:F9:6E:EA:4E","98:DE:D0:DB:BE:F8","D4:6E:0E:4F:4F:24","D4:6E:0E:4F:30:A8","84:16:F9:AC:3E:80","D4:6E:0E:4F:2B:8C","98:DE:D0:90:F7:00","18:D6:C7:43:29:7C","60:E3:27:93:35:CE","D4:6E:0E:4F:4E:E2","D4:6E:0E:4F:28:9E"), x = c(0,180,180,180,180,180,490,490,1120,1120,1726,1726), y = c(0,162,331,421,581,679,331,581,331,581,331,581))
#########################################
#           AREAS Coordinates
#########################################
area = list()

area$pernambucanas_campaign2 = rbind(data.table(x = c(3.89368421052632,-2.18842105263158,-0.0284210526315788,5.78350877192982,3.89368421052632), y = c(6.11052631578947,21.0736842105263,21.0736842105263,7.11929824561403,6.11052631578947), area = 'Vitrine'), data.table(x = c(27.9087719298246,27.9087719298246,25.9477192982456,25.9477192982456,27.9087719298246,27.9087719298246,31.3761403508772,31.3761403508772,27.9087719298246), y = c(13.1585964912281,16.0575438596491,16.0575438596491,19.6954385964912,19.6954385964912,25.0666666666667,25.0666666666667,13.1585964912281,13.1585964912281), area = 'Provador'), data.table(x = c(14.2529824561403,14.2529824561403,22.0277192982456,22.0277192982456,20.9224561403509,20.9224561403509,14.2529824561403), y = c(30.6087719298246,43.6821052631579,43.6821052631579,39.059649122807,39.059649122807,30.6087719298246,30.6087719298246), area = 'Caixa'), data.table(x = c(5.78350877192982,4.12175438596491,14.2529824561403,14.2529824561403,5.78350877192982), y = c(7.11929824561403,10.8445614035088,10.8445614035088,7.11929824561403,7.11929824561403), area = 'Entrada - Corredor Sul'), data.table(x = c(4.12175438596491,1.67017543859649,14.2529824561403,14.2529824561403,4.12175438596491), y = c(10.8445614035088,16.8733333333333,16.8733333333333,10.8445614035088,10.8445614035088), area = 'Entrada - Central'), data.table(x = c(1.67017543859649,-0.0284210526315788,14.2529824561403,14.2529824561403,1.67017543859649), y = c(16.8733333333333,21.0736842105263,21.0736842105263,16.8733333333333,16.8733333333333), area = 'Entrada - Corredor Norte'), data.table(x = c(14.2529824561403,14.2529824561403,31.3761403508772,31.3761403508772,14.2529824561403), y = c(0.0852631578947368,3.77052631578947,3.77052631578947,0.0852631578947368,0.0852631578947368), area = 'Masculino - Corredor Sul'), data.table(x = c(14.2529824561403,14.2529824561403,31.3761403508772,31.3761403508772,14.2529824561403), y = c(3.77052631578947,7.11929824561403,7.11929824561403,3.77052631578947,3.77052631578947), area = 'Masculino - Corredor Norte'), data.table(x = c(20.9224561403509,20.9224561403509,28.0364912280702,28.0364912280702,20.9224561403509), y = c(25.0666666666667,32.2270175438597,32.2270175438597,25.0666666666667,25.0666666666667), area = 'Casa - Atração'), data.table(x = c(20.9224561403509,20.9224561403509,31.3761403508772,31.3761403508772,27.9087719298246,27.9087719298246,20.9224561403509), y = c(32.2270175438597,39.019649122807,39.019649122807,25.0666666666667,25.0666666666667,32.2270175438597,32.2270175438597), area = 'Casa - Fundos'), data.table(x = c(14.2529824561403,14.2529824561403,20.9224561403509,20.9224561403509,27.9087719298246,27.9087719298246,25.9477192982456,25.9477192982456,27.9087719298246,27.9087719298246,14.2529824561403), y = c(14.5424561403509,30.6087719298246,30.6087719298246,25.0666666666667,25.0666666666667,19.6954385964912,19.6954385964912,16.0575438596491,16.0575438596491,14.5424561403509,14.5424561403509), area = 'Feminino'), data.table(x = c(22.7308771929825,22.7308771929825,27.9087719298246,27.9087719298246,31.3761403508772,31.3761403508772,22.7308771929825), y = c(7.11929824561403,14.5424561403509,14.5424561403509,13.1585964912281,13.1585964912281,7.11929824561403,7.11929824561403), area = 'Infantil'), data.table(x = c(14.2529824561403,14.2529824561403,22.7308771929825,22.7308771929825,14.2529824561403), y = c(7.11929824561403,14.5424561403509,14.5424561403509,7.11929824561403,7.11929824561403), area = 'Calçados'))

area$claro_campaign1 = rbind(data.table(x = c(5.44718100890208,5.44718100890208,6.96275964391691,6.96275964391691,5.62121661721068), y = c( 0,1.99940652818991,1.99940652818991,0,0), area = 'Balcão de Atendimento'), data.table(x = c(0,0,5.44718100890208,5.44718100890208,0), y = c( 1.22373887240356,5.57314540059347,5.57314540059347,1.22373887240356,1.22373887240356), area = 'TVs'),data.table(x=c(0,0,7.67804154302671,7.67804154302671,6.96275964391691,6.96275964391691,0), y=c( 5.57314540059347,14.8738872403561,14.8738872403561,8.56824925816024,8.56824925816024,5.57314540059347,5.57314540059347), area = 'Central de Ajuda'), data.table(x=c(1.17270029673591,1.17270029673591,1.86305637982196,1.86305637982196,1.17270029673591), y=c(5.57314540059347,10.0719584569733,10.0719584569733,5.57314540059347,5.57314540059347), area = 'Mesa 1'), data.table(x=c(1.17270029673591,1.17270029673591,1.86498516320475,1.86498516320475,1.17270029673591), y=c(11.8807121661721,14.8738872403561,14.8738872403561,11.8807121661721,11.8807121661721), area = 'Mesa 2'), data.table(x=c(4.73456973293769,4.73456973293769,5.42344213649852,5.42344213649852,4.73456973293769), y=c(7.37863501483679,14.8738872403561,14.8738872403561,7.37863501483679,7.37863501483679), area = 'Mesa 3'))

area$claro_campaign31 = rbind(data.table(x = c(0,0,52.73,52.73,0), y = c(0,52.63,52.63,0,0), area = 'Token'), data.table(x = c(0,0,100,100,0), y = c(100.43,1160.57,1160.57,100.43,100.43), area = 'Espera'), data.table(x = c(279.119,279.119,1169.448,1169.448,279.119), y = c(722.765,794.073,794.073,722.765,722.765), area = 'Atendimento'), data.table(x = c(1306.461,1306.461,1378.533,1378.533,1306.461), y = c(81.504,680.49,680.49,81.504,81.504), area = 'Preferencial'), data.table(x = c(305.861,305.861,409.876,409.876,305.861), y = c(283.230,362.262,362.262,283.230,283.230), area = 'Celulares'), data.table(x = c(945.824,945.824,1024.888,1024.888,945.824), y = c(134.781,213.8,213.8,134.781,134.781), area = 'Galaxy'), data.table(x = c(0,0,630,630,0), y = c(1239.16,1321,1321,1239.16,1239.16), area = 'Caixa'), data.table(x = c(0,0,1064.85,1064.85,0), y = c(-98.25,0,0,-98.25,-98.25), area = 'Entrada'), data.table(x = c(1064.85,1064.85,1545.4,1545.4,1064.85), y = c(-98.25,0,0,-98.25,-98.25), area = 'Vitrine'))

area$claro_campaign35 = rbind(data.table(x = c(0,0,100,100,0), y = c(0,100,100,0,0), area = 'Stand 1'), data.table(x = c(120,120,240,240,120), y = c(126,246,246,126,126), area = 'Stand 2'), data.table(x = c(120,120,240,240,120), y = c(126,246,246,126,126) + 1*120, area = 'Stand 3'), data.table(x = c(120,120,240,240,120), y = c(126,246,246,126,126) + 2*120, area = 'Stand 4'), data.table(x = c(120,120,240,240,120), y = c(126,246,246,126,126) + 3*120, area = 'Stand 5'), data.table(x = c(120,120,240,240,120), y = c(606,729,729,606,606), area = 'Stand 6'), data.table(x = c(430,430,550,550,430), y = c(126,729,729,126,126), area = 'Mesa 1'), data.table(x = c(1060,1060,1180,1180,1060), y = c(126,729,729,126,126), area = 'Mesa 2'), data.table(x = c(1666,1666,1786,1786,1666), y = c(126,729,729,126,126), area = 'Mesa 3'))

# Transform object to SpatialPolygon
areas_legend = function(client, campaign, pos_x = c(0,0), pos_y = c(0,0)){
  # Aux lists
  area_poly = list()
  if(length(pos_x)==1){
    pos_x[2] = pos_x[1]
  }
  if(length(pos_y)==1){
    pos_y[2] = pos_y[1]
  }
  # Split coords by area
  eval(parse(text = paste0('area_sp$',client,'_campaign',campaign,' <<- split(area$',client,'_campaign',campaign,', area$',client,'_campaign',campaign,'$area)')))
  # Remove column area
  eval(parse(text = paste0('area_sp$',client,'_campaign',campaign,' <<- lapply(area_sp$',client,'_campaign',campaign,', function(x) { x[,area:=NULL]})')))
  # Creates a Polygon object
  eval(parse(text = paste0('area_poly$',client,' = sapply(area_sp$',client,'_campaign',campaign,', Polygon)')))
  # add id variable
  eval(parse(text = paste0('area_poly$',client,' = lapply(seq_along(area_poly$',client,'), function(i) Polygons(list(area_poly$',client,'[[i]]), ID = names(area_sp$',client,'_campaign',campaign,')[i]))')))
  # SpatialPolygons object
  eval(parse(text = paste0('area_sp$',client,'_campaign',campaign,' <<- SpatialPolygons(area_poly$',client,')')))
  # Centroids coords
  eval(parse(text = paste0('labels$',client,'_campaign',campaign,' <<- as.data.table(gCentroid(area_sp$',client,'_campaign',campaign,',byid=TRUE))')))
  # Add Labels
  eval(parse(text = paste0('labels$',client,'_campaign',campaign,'[,labels:=row.names(gCentroid(area_sp$',client,'_campaign',campaign,',byid=TRUE))]')))
  # Creates de_para
  eval(parse(text = paste0('labels$',client,'_campaign',campaign,"[,de_para:=1:.N][,`:=`(text=paste(de_para,labels,sep = '. '), leg.x=seq(",pos_x[1],',',pos_x[2],',length.out = .N)',", leg.y=seq(",pos_y[1],',',pos_y[2],',length.out = .N))]')))
}

# Areas as SpatialPolygons object
area_sp = list()
# Areas labels
labels = list()
areas_legend('pernambucanas',2,c(13,-5),42)
areas_legend('claro',1,c(-1,-5),15)
areas_legend('claro',31,c(1500,700),1300)
areas_legend('claro',35,c(1450,700),1050)
# Color legend position
# col_legend = list()
# col_legend$pernambucanas$campaign1 = list(xl = 0, xr = 20, yb = -20, yt = 0)
# col_legend$claro$campaign1 = list(xl = 0, xr = 10, yb = -20, yt = 0)
# col_legend$claro$campaign31 = list(xl = 0, xr = 10, yb = -20, yt = 0)