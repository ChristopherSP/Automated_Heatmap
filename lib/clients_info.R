# Store coordinates
coords = list()
# coords$pernambucanas = data.table( x = c(466.55, 466.55, 227.61, 62.37, 466.55, 466.55, 688.49, 688.49, 957.40, 957.40), y = c(43.74, 247.86, 247.86, 644.75, 644.75, 1286.25, 1286.25, 1155.85, 1155.85, 43.74))
# pernambucanas_minx = min(coords$pernambucanas$x)
# pernambucanas_miny = min(coords$pernambucanas$y)
# coords$pernambucanas[,`:=`(x = (x-pernambucanas_minx)/28.5, y = (y-pernambucanas_miny)/28.5)]

coords$pernambucanas = data.table( x = c(14.1817543859649,14.1817543859649,5.79789473684211,0,14.1817543859649,14.1817543859649,21.9691228070175,21.9691228070175,31.4045614035088,31.4045614035088), y = c(0,7.16210526315789,7.16210526315789,21.0880701754386,21.0880701754386,43.5968421052632,43.5968421052632,39.0214035087719,39.0214035087719,0))

# coords$claro = data.table(x = c(112.32, 112.32, 629.82, 629.82, 581.61, 581.61), y = c(22.50, 1024.82, 1024.64, 599.82, 599.82, 22.32))
# claro_minx = min(coords$claro$x)
# claro_miny = min(coords$claro$y)
# coords$claro[,`:=`(x = (x-claro_minx)/67.4, y = (y-claro_miny)/67.4)]

coords$claro = data.table(x = c(0,0,7.67804154302671,7.67804154302671,6.96275964391691,6.96275964391691), y = c(0.00267062314540059,14.8738872403561,14.8712166172107,8.56824925816024,8.56824925816024,0))

# Blacklist
list.vendors = list()
list.vendors$pernambucanas = c("AirgoNet","AtherosC","D-LinkIn","HonHaiPr","Hongkong","MurataMa","Tp-LinkT","Zte","Intermec","SkardinU","Palladiu","HonHaiPr","HuaweiTe","BenruiTe")

# Sensors coords
macs = list()
# macs$pernambucanas = data.table(id_sensor = c('18:D6:C7:43:4D:54','18:D6:C7:43:26:48','98:DE:D0:DB:C6:54','98:DE:D0:DB:C2:28','60:E3:27:93:35:96','60:E3:27:93:29:0E','18:D6:C7:43:2A:06','18:D6:C7:43:51:AE','60:E3:27:93:33:E4','98:DE:D0:DB:CB:18','98:DE:D0:A0:55:E0','60:E3:27:93:34:36','18:D6:C7:43:28:F2','98:DE:D0:90:BD:D2','18:D6:C7:43:52:2E','98:DE:D0:DB:C7:86','98:DE:D0:DB:C4:96','98:DE:D0:DB:BE:74','98:DE:D0:DB:C2:1A','18:D6:C7:43:4F:D8','18:D6:C7:43:29:4C','98:DE:D0:DB:C0:8E','18:D6:C7:43:2B:D2'),name = c('Area Masculina - Canto','Provador - Porta','Provador - Lateral','Feminino','Porta da Loja - Sul','Infantil','Area Entrada - Sul','Esportivo','Area Entrada','Fundo Loja','Area Caixa','Porta da Loja','Caixa Fundo','Area Casa - Canto','Provador','Area Masculina','Area Casa','Baia Central - Solo','Area Casa - Emergencia','Baia Central','Caixa','Lingerie','Caixa Meio'),x = c(469.65,854.54,923.26,504.59,334.48,952.47,462.21,936.44,450.18,952.47,698.75,194.16,537.81,928.42,942.74,711.35,831.05,481.68,924.41,541.82,542.39,478.81,536.09),y = c(75.6,481.68,786.95,763.47,268.04,346.51,254.87,71.02,636.32,256.59,1154.65,626.58,1214.22,1150.64,585.92,195.31,993.71,372.86,853.96,452.47,946.75,661.52,1089.36))
# macs$pernambucanas[,`:=`(x = (x-pernambucanas_minx)/28.5, y = (y-pernambucanas_miny)/28.5)]

macs$pernambucanas = data.table(id_sensor = c('18:D6:C7:43:4D:54','18:D6:C7:43:26:48','98:DE:D0:DB:C6:54','98:DE:D0:DB:C2:28','60:E3:27:93:35:96','60:E3:27:93:29:0E','18:D6:C7:43:2A:06','18:D6:C7:43:51:AE','60:E3:27:93:33:E4','98:DE:D0:DB:CB:18','98:DE:D0:A0:55:E0','60:E3:27:93:34:36','18:D6:C7:43:28:F2','98:DE:D0:90:BD:D2','18:D6:C7:43:52:2E','98:DE:D0:DB:C7:86','98:DE:D0:DB:C4:96','98:DE:D0:DB:BE:74','98:DE:D0:DB:C2:1A','18:D6:C7:43:4F:D8','18:D6:C7:43:29:4C','98:DE:D0:DB:C0:8E','18:D6:C7:43:2B:D2'),name = c('Area Masculina - Canto','Provador - Porta','Provador - Lateral','Feminino','Porta da Loja - Sul','Infantil','Area Entrada - Sul','Esportivo','Area Entrada','Fundo Loja','Area Caixa','Porta da Loja','Caixa Fundo','Area Casa - Canto','Provador','Area Masculina','Area Casa','Baia Central - Solo','Area Casa - Emergencia','Baia Central','Caixa','Lingerie','Caixa Meio'),x = c(14.2905263157895,27.7954385964912,30.2066666666667,15.5164912280702,9.54771929824561,31.2315789473684,14.0294736842105,30.6691228070175,13.6073684210526,31.2315789473684,22.3291228070175,4.62421052631579,16.6821052631579,30.3877192982456,30.8901754385965,22.7712280701754,26.9712280701754,14.7126315789474,30.2470175438596,16.8228070175439,16.8428070175439,14.6119298245614,16.6217543859649),y = c(1.11789473684211,15.3663157894737,26.0775438596491,25.2536842105263,7.87017543859649,10.6235087719298,7.4080701754386,0.95719298245614,20.7922807017544,7.46842105263158,38.979298245614,20.4505263157895,41.0694736842105,38.8385964912281,19.0238596491228,5.31824561403509,33.3322807017544,11.5480701754386,28.4287719298246,14.3414035087719,31.6845614035088,21.6764912280702,36.6884210526316))


# macs$claro = data.table(id_sensor = c('98:DE:D0:DB:C1:74','D4:6E:0E:4F:2D:B6','18:D6:C7:43:56:56','98:DE:D0:DB:C7:00','84:16:F9:AC:51:46'), name = c('Entrada Segurança', 'TVs', 'Baia Entrada', 'Baia Central', 'Baia Fundo'), x = c(503.06, 364.17, 443.96, 231.32, 440.43), y = c(135.87, 344.46, 538.41, 840.45, 943.48))
# macs$claro[,`:=`(x = (x-claro_minx)/67.4, y = (y-claro_miny)/67.4)]

macs$claro = data.table(id_sensor = c('98:DE:D0:DB:CC:CE','60:E3:27:93:35:7E','98:DE:D0:DB:C7:86','84:16:F9:AC:4A:06','18:A6:F7:AF:4D:54'), name = c('Entrada Segurança', 'TVs', 'Baia Entrada', 'Baia Central', 'Baia Fundo'), x = c(5.7973293768546,3.736646884273,4.92047477744807,1.76557863501484,4.86810089020771), y = c(1.68471810089021,4.77952522255193,7.65712166172107,12.1384272997033,13.6670623145401))

#########################################
#           AREAS Coordinates
#########################################
area = list()

# area$pernambucanas = rbind(data.table(x = c(173.34, 0,  61.56, 227.20, 173.34), y = c(217.89, 644.34, 644.34, 246.64, 217.89), area = 'Vitrine'), data.table(x = c(857.77, 857.77, 801.88, 801.88, 857.77, 857.77, 956.59, 956.59, 857.77), y = c(418.76, 501.38, 501.38, 605.06, 605.06, 758.14, 758.14, 418.76, 418.76), area = 'Provador'), data.table(x = c(468.58, 468.58, 690.16, 690.16, 658.66, 658.66, 468.58), y = c(916.09, 1288.68, 1288.68, 1156.94, 1156.94, 916.09, 916.09), area = 'Caixa'), data.table(x = c(227.20, 179.84, 468.58, 468.58, 227.20), y = c(246.64, 352.81, 352.81, 246.64,246.64), area = 'Entrada - Corredor Sul'), data.table(x = c(179.84, 109.97, 468.58, 468.58,179.84), y = c(352.81, 524.63, 524.63, 352.81,352.81), area = 'Entrada - Central'), data.table(x = c(109.97, 61.56,  468.58, 468.58,109.97), y = c(524.63, 644.34, 644.34, 524.63,524.63), area = 'Entrada - Corredor Norte'), data.table(x = c(468.58, 468.58, 956.59, 956.59, 468.58), y = c(46.17, 151.20, 151.20, 46.17, 46.17), area = 'Masculino - Corredor Sul'), data.table(x = c(468.58, 468.58, 956.59, 956.59, 468.58), y = c(151.20, 246.64, 246.64, 151.20, 151.20), area = 'Masculino - Corredor Norte'), data.table(x = c(658.66, 658.66, 861.41, 861.41, 658.66), y = c(758.14, 962.21, 962.21, 758.14, 758.14), area = 'Casa - Atração'), data.table(x = c(658.66, 658.66, 956.59, 956.59, 857.77, 857.77, 658.66), y = c(962.21, 1155.80, 1155.80, 758.14, 758.14, 962.21, 962.21), area = 'Casa - Fundos'), data.table(x = c(468.58, 468.58, 658.66, 658.66, 857.77, 857.77, 801.88, 801.88, 857.77, 857.77, 468.58), y = c(458.20, 916.09, 916.09, 758.14, 758.14, 605.06, 605.06, 501.38, 501.38, 458.20, 458.20), area = 'Feminino'), data.table(x = c(710.20, 710.20, 857.77, 857.77, 956.59, 956.59, 710.20), y = c(246.64, 458.20, 458.20, 418.76, 418.76, 246.64, 246.64), area = 'Infantil'), data.table(x = c(468.58, 468.58, 710.20, 710.20, 468.58), y = c(246.64, 458.20, 458.20, 246.64, 246.64), area = 'Calçados'))
# area$pernambucanas[,`:=`(x = (x-pernambucanas_minx)/28.5, y = (y-pernambucanas_miny)/28.5)]

area$pernambucanas = rbind(data.table(x = c(3.89368421052632,-2.18842105263158,-0.0284210526315788,5.78350877192982,3.89368421052632), y = c(6.11052631578947,21.0736842105263,21.0736842105263,7.11929824561403,6.11052631578947), area = 'Vitrine'), data.table(x = c(27.9087719298246,27.9087719298246,25.9477192982456,25.9477192982456,27.9087719298246,27.9087719298246,31.3761403508772,31.3761403508772,27.9087719298246), y = c(13.1585964912281,16.0575438596491,16.0575438596491,19.6954385964912,19.6954385964912,25.0666666666667,25.0666666666667,13.1585964912281,13.1585964912281), area = 'Provador'), data.table(x = c(14.2529824561403,14.2529824561403,22.0277192982456,22.0277192982456,20.9224561403509,20.9224561403509,14.2529824561403), y = c(30.6087719298246,43.6821052631579,43.6821052631579,39.059649122807,39.059649122807,30.6087719298246,30.6087719298246), area = 'Caixa'), data.table(x = c(5.78350877192982,4.12175438596491,14.2529824561403,14.2529824561403,5.78350877192982), y = c(7.11929824561403,10.8445614035088,10.8445614035088,7.11929824561403,7.11929824561403), area = 'Entrada - Corredor Sul'), data.table(x = c(4.12175438596491,1.67017543859649,14.2529824561403,14.2529824561403,4.12175438596491), y = c(10.8445614035088,16.8733333333333,16.8733333333333,10.8445614035088,10.8445614035088), area = 'Entrada - Central'), data.table(x = c(1.67017543859649,-0.0284210526315788,14.2529824561403,14.2529824561403,1.67017543859649), y = c(16.8733333333333,21.0736842105263,21.0736842105263,16.8733333333333,16.8733333333333), area = 'Entrada - Corredor Norte'), data.table(x = c(14.2529824561403,14.2529824561403,31.3761403508772,31.3761403508772,14.2529824561403), y = c(0.0852631578947368,3.77052631578947,3.77052631578947,0.0852631578947368,0.0852631578947368), area = 'Masculino - Corredor Sul'), data.table(x = c(14.2529824561403,14.2529824561403,31.3761403508772,31.3761403508772,14.2529824561403), y = c(3.77052631578947,7.11929824561403,7.11929824561403,3.77052631578947,3.77052631578947), area = 'Masculino - Corredor Norte'), data.table(x = c(20.9224561403509,20.9224561403509,28.0364912280702,28.0364912280702,20.9224561403509), y = c(25.0666666666667,32.2270175438597,32.2270175438597,25.0666666666667,25.0666666666667), area = 'Casa - Atração'), data.table(x = c(20.9224561403509,20.9224561403509,31.3761403508772,31.3761403508772,27.9087719298246,27.9087719298246,20.9224561403509), y = c(32.2270175438597,39.019649122807,39.019649122807,25.0666666666667,25.0666666666667,32.2270175438597,32.2270175438597), area = 'Casa - Fundos'), data.table(x = c(14.2529824561403,14.2529824561403,20.9224561403509,20.9224561403509,27.9087719298246,27.9087719298246,25.9477192982456,25.9477192982456,27.9087719298246,27.9087719298246,14.2529824561403), y = c(14.5424561403509,30.6087719298246,30.6087719298246,25.0666666666667,25.0666666666667,19.6954385964912,19.6954385964912,16.0575438596491,16.0575438596491,14.5424561403509,14.5424561403509), area = 'Feminino'), data.table(x = c(22.7308771929825,22.7308771929825,27.9087719298246,27.9087719298246,31.3761403508772,31.3761403508772,22.7308771929825), y = c(7.11929824561403,14.5424561403509,14.5424561403509,13.1585964912281,13.1585964912281,7.11929824561403,7.11929824561403), area = 'Infantil'), data.table(x = c(14.2529824561403,14.2529824561403,22.7308771929825,22.7308771929825,14.2529824561403), y = c(7.11929824561403,14.5424561403509,14.5424561403509,7.11929824561403,7.11929824561403), area = 'Calçados'))

# area$claro = rbind(data.table(x = c(479.46, 479.46, 581.61, 581.61, 491.19), y = c(22.32,157.08,157.08,22.32,22.32), area = 'Balcão de Atendimento'), data.table(x = c(112.32,112.32,479.46,479.46,112.32), y = c(104.80,397.95,397.95,104.80,104.80), area = 'TVs'),data.table(x=c(112.32, 112.32, 629.82, 629.82, 581.61, 581.61, 112.32), y=c(397.95, 1024.82, 1024.82, 599.82, 599.82, 397.95, 397.95), area = 'Central de Ajuda'), data.table(x=c(191.36, 191.36, 237.89, 237.89, 191.36), y=c(397.95, 701.17, 701.17, 397.95, 397.95), area = 'Mesa 1'), data.table(x=c(191.36,191.36,238.02,238.02,191.36), y=c(823.08,1024.82,1024.82,823.08,823.08), area = 'Mesa 2'), data.table(x=c(431.43,431.43,477.86,477.86,431.43), y=c(519.64,1024.82,1024.82,519.64,519.64), area = 'Mesa 3'))
# area$claro[,`:=`(x = (x-claro_minx)/67.4, y = (y-claro_miny)/67.4)]

area$claro = rbind(data.table(x = c(5.44718100890208,5.44718100890208,6.96275964391691,6.96275964391691,5.62121661721068), y = c( 0,1.99940652818991,1.99940652818991,0,0), area = 'Balcão de Atendimento'), data.table(x = c(0,0,5.44718100890208,5.44718100890208,0), y = c( 1.22373887240356,5.57314540059347,5.57314540059347,1.22373887240356,1.22373887240356), area = 'TVs'),data.table(x=c(0,0,7.67804154302671,7.67804154302671,6.96275964391691,6.96275964391691,0), y=c( 5.57314540059347,14.8738872403561,14.8738872403561,8.56824925816024,8.56824925816024,5.57314540059347,5.57314540059347), area = 'Central de Ajuda'), data.table(x=c(1.17270029673591,1.17270029673591,1.86305637982196,1.86305637982196,1.17270029673591), y=c(5.57314540059347,10.0719584569733,10.0719584569733,5.57314540059347,5.57314540059347), area = 'Mesa 1'), data.table(x=c(1.17270029673591,1.17270029673591,1.86498516320475,1.86498516320475,1.17270029673591), y=c(11.8807121661721,14.8738872403561,14.8738872403561,11.8807121661721,11.8807121661721), area = 'Mesa 2'), data.table(x=c(4.73456973293769,4.73456973293769,5.42344213649852,5.42344213649852,4.73456973293769), y=c(7.37863501483679,14.8738872403561,14.8738872403561,7.37863501483679,7.37863501483679), area = 'Mesa 3'))

# Transform object to SpatialPolygon
areas_legend = function(stablishment, pos_x = c(0,0), pos_y = c(0,0)){
  # Aux lists
  area_poly = list()
  if(length(pos_x)==1){
    pos_x[2] = pos_x[1]
  }
  if(length(pos_y)==1){
    pos_y[2] = pos_y[1]
  }
  # Split coords by area
  eval(parse(text = paste0('area_sp$',stablishment,' <<- split(area$',stablishment,', area$',stablishment,'$area)')))
  # Remove column area
  eval(parse(text = paste0('area_sp$',stablishment,' <<- lapply(area_sp$',stablishment,', function(x) { x[,area:=NULL]})')))
  # Creates a Polygon object
  eval(parse(text = paste0('area_poly$',stablishment,' = sapply(area_sp$',stablishment,', Polygon)')))
  # add id variable
  eval(parse(text = paste0('area_poly$',stablishment,' = lapply(seq_along(area_poly$',stablishment,'), function(i) Polygons(list(area_poly$',stablishment,'[[i]]), ID = names(area_sp$',stablishment,')[i]))')))
  # SpatialPolygons object
  eval(parse(text = paste0('area_sp$',stablishment,' <<- SpatialPolygons(area_poly$',stablishment,')')))
  # Centroids coords
  eval(parse(text = paste0('labels$',stablishment,' <<- as.data.table(gCentroid(area_sp$',stablishment,',byid=TRUE))')))
  # Add Labels
  eval(parse(text = paste0('labels$',stablishment,'[,labels:=row.names(gCentroid(area_sp$',stablishment,',byid=TRUE))]')))
  # Creates de_para
  eval(parse(text = paste0('labels$',stablishment,"[,de_para:=1:.N][,`:=`(text=paste(de_para,labels,sep = '. '), leg.x=seq(",pos_x[1],',',pos_x[2],',length.out = .N)',", leg.y=seq(",pos_y[1],',',pos_y[2],',length.out = .N))]')))
}

# Areas as SpatialPolygons object
area_sp = list()
# Areas labels
labels = list()
areas_legend('pernambucanas',c(13,-5),42)
areas_legend('claro',c(-1,-5),15)

# Color legend position
col_legend = list()
col_legend$pernambucanas = list(xl = 0, xr = 20, yb = -20, yt = 0)
col_legend$claro = list(xl = 0, xr = 10, yb = -20, yt = 0)
